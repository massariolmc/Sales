{% extends 'core/base.html' %}
{% load static %}
{% load i18n %}

{% block css %}
  <!-- iCheck for checkboxes and radio inputs -->
  <link rel="stylesheet" href="{% static 'core/plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
  <!-- DATA TABLES -->
  <link rel="stylesheet" href="{% static 'core/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css' %}">
  <link rel="stylesheet" href="{% static 'core/plugins/datatables-responsive/css/responsive.bootstrap4.min.css' %}">

      <!-- Toastr -->
  <link rel="stylesheet" href="{% static 'core/plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css' %}">
  <link rel="stylesheet" href="{% static 'core/plugins/toastr/toastr.min.css' %}">
  
{% endblock css %}

{% block content %}

{% block title %}
{% endblock title %}

{% include 'default/_messages.html' %}

          <!-- DataTales Example -->
          <div class="card shadow mb-4">
            <div class="card-header py-3">
              <div class="row">
                <div class="col-sm-6">
                  <h6 class="m-0 font-weight-bold text-primary">{{ title }}</h6>
                </div>
                <div class="col-sm-6">
                  <span class="float-right">
                    <a href="{% url 'person:url_create_user_and_person' %}">
                      <button type="button" class="btn btn-success">{{ add }}
                      </button>
                    </a>
                  </span>
              </div>
            </div>
          </div>

            <div class="card-body">
              <div class="table-responsive">
                {% include 'person/_table.html' %}
              </div>
              <button data-url="{% url 'person:url_person_delete_all' %}" data-js="click_checkbox" class="btn btn-danger" ><i class="fas fa-minus-circle fa-1x"></i>{% trans "Remove" %}</button>
            </div>
             
{% include 'default/_modal_delete.html' %}

{% include 'default/_modal_checkbox.html' %}

{% endblock content %}

{% block js %}
<script src="{% static 'core/plugins/datatables/jquery.dataTables.min.js'%}"></script>
<script src="{% static 'core/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js'%}"></script>
<script src="{% static 'core/plugins/datatables-responsive/js/dataTables.responsive.min.js'%}"></script>
<script src="{% static 'core/plugins/datatables-responsive/js/responsive.bootstrap4.min.js'%}"></script>


<script src="{% static 'default/js/checkbox_delete_all.js'%}"></script>
<script src="{% static 'default/js/dataTables_default.js'%}"></script>
<!-- Bootstrap Switch -->
<script src="{% static 'core/plugins/bootstrap-switch/js/bootstrap-switch.min.js'%}"></script>
<!-- TOAST -->
<script src="{% static 'core/plugins/sweetalert2/sweetalert2.min.js'%}"></script>
<script src="{% static 'core/plugins/toastr/toastr.min.js'%}"></script>

<script>

(function(win,doc){
  const Toast = Swal.mixin({
      toast: true,
      position: 'top-end',
      showConfirmButton: false,
      timer: 3000
    });

  function openToastSuccess() {
      var message = $('[data-js="message_success"]').attr('value')     
      toastr.success(message)    
    };

  var ck = function(){
    var sw = $(this);
    $.ajax({
      url: sw.attr("data-url"),
      data: {'sw': sw.is(':checked')},
      headers: {'X-CSRFToken': sw.attr("data-token")},
      type: 'post',
      dataType: 'json',
      success: function (data) {                         
        if(data.is_valid){          
          openToastSuccess();
        }        
      }
    });    
  };

  $("#person_table").on("change", '.js-checkbox-switch', ck);

})(window,document) 

</script>
{% endblock js %}
